{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div id="home" class="flex-center flex-column">
    <h1 class="text-center">Admin</h1>
    <hr>
    <h4>Season {{ schools[0]['season'] }} in progress!</h4>
    <hr>
    <h4>Students Registered: {{ total_students_all_schools - 1 }}</h4>
    <h4>Schools registered:</h4>
    <p>({{ num_of_schools - 1 }} schools registered)</p>
    <hr>
    
    <div class="school-list">
        {% for school in schools %}
        <div class="school-item">
            <strong>{{ school['name'] }} ({{ school['group_count'] }} groups, {{ school['total_students'] }} students)</strong>
            <ul>
                {% for group in school['groups'] %}
                <li>
                    {{ group.name }} - Passcode: {{ group.passcode }} - {{ group.student_count }} students.
                    <ul>
                        <li><strong>Students:</strong></li>
                        {% for student in group['students'] %}
                        <li>{{ student.name | title }}</li>
                        {% endfor %}
                    </ul>
                </li>
                {% endfor %}
            </ul>
            <form action="{{ url_for('delete_school', id=school['id']) }}" method="POST" class="delete-form">
                <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this school? All participants and groups registered under this school will also be deleted!');">Delete</button>
            </form>
            <form action="{{ url_for('archive_school', school_id=school['id']) }}" method="POST" class="archive-form">
                <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to archive this school?');">Archive School</button>
            </form>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}